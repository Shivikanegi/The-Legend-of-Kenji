<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Legend of Kenji | An AI Storytelling Project</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Noto+Serif+JP:wght@300;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles/theme.css">
</head>
<body>

    <!-- HERO SECTION (Step 4: Visual Identity) -->
    <header>
        <figure class="hero-figure" aria-hidden="false">
            <img src="cover.png" alt="Cover artwork for The Legend of Kenji">
        </figure>
        <img class="hero-silhouette" src="assets/hero-silhouette.svg" alt="" aria-hidden="true">
        <div class="petal-canvas" aria-hidden="true"></div>
        <h1>The Legend of Kenji</h1>
        
        <!-- Step 6: Audio Narration -->
        <div class="audio-container">
            <div class="audio-petal-accent" aria-hidden="true"></div>
            <div class="audio-header">
                <svg class="audio-icon" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 2c1.2 2.6 3.8 3 5 5c-2 0-3 1.4-4 2.8C12.8 10.8 11.6 12 10 12c-1.8 0-2.6-1.6-3.6-2.2C4.8 9.2 3.8 8.8 2 8c1.4-2 3.6-3 5-6 1.8 2 4.2 1.6 5 0z" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="audio-title">The Legend Narration</span>
            </div>
            <audio controls>
                <source src="audio.wav" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>
        <!-- Additional audio playback (alternate soundtrack / ambient) -->
        <div class="audio-container">
            <div class="audio-petal-accent" aria-hidden="true"></div>
            <div class="audio-header">
                <svg class="audio-icon" width="20" height="20" viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 2c1.2 2.6 3.8 3 5 5c-2 0-3 1.4-4 2.8C12.8 10.8 11.6 12 10 12c-1.8 0-2.6-1.6-3.6-2.2C4.8 9.2 3.8 8.8 2 8c1.4-2 3.6-3 5-6 1.8 2 4.2 1.6 5 0z" fill="none" stroke="currentColor" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="audio-title">Blade of the Turning Sky</span>
            </div>
            <div class="audio-meta" aria-hidden="true">Background music</div>
            <audio id="ambient-audio" controls loop autoplay playsinline aria-label="Ambient soundtrack: Blade of the Turning Sky">
                <source src="Blade of the Turning Sky.mp3" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        </div>
        <!-- Audio enable toast/button -->
        <div id="audio-toast" class="audio-toast" role="dialog" aria-live="polite">
            <button id="enable-audio-btn" class="enable-audio-btn" aria-label="Enable audio">Click to enable audio</button>
            <button id="dismiss-audio-toast" class="dismiss-audio-toast" aria-label="Dismiss audio prompt">✕</button>
        </div>
    </header>

    <!-- STORY SECTION (Step 3: Narrative Expansion) -->
    <div class="container">
        <div class="story-text">
            <span class="dropcap">L</span>ong ago, in the land of the rising sun, where the mountains kissed the clouds and cherry blossoms painted the wind, there lived a samurai named Kenji. His armor was black as ink, polished by the winds of a hundred battles. They said he fought not for kings or gold, but for the spirit of honor itself.

            Every spring, Kenji returned to a quiet hill overlooking a small village. There, beneath an old shrine and a great cherry tree, he knelt in remembrance of his master — a wise man who had fallen defending the innocent. The villagers would watch from afar, whispering that Kenji’s spirit guarded them still, even when he was unseen.

            One morning, as pale mist curled through the trees, a young boy climbed the hill, clutching a wooden sword carved by his own hands. “Great warrior,” the boy said, “teach me to be strong like you.”

            Kenji looked upon him kindly. “Strength is not in the blade,” he said, “but in the heart that holds it steady.”

            From that day, the villagers saw the old samurai and the boy practice beneath the cherry tree. Seasons passed, blossoms fell, and the boy grew tall. When Kenji’s time at last came to rest, the legend says his spirit became the wind that carries the petals each spring — whispering lessons of courage and harmony to all who listen.

            And so, each year, when the first blossom falls, the people bow toward the hill and say,
            <em style="color: var(--blossom-pink);">“The samurai still guards us, not with his sword — but with his heart.”</em>
        </div>
    </div>

    <!-- CHARACTER DESIGN (Step 7) -->
    <div class="container">
        <h2 class="section-title">THE CHARACTERS</h2>
        <div class="character-grid">
            <!-- Character 1 -->
            <div class="character-card">
                <img src="kenji.png" alt="Kenji the Samurai">
                <h3>Kenji</h3>
                <p>The Ink-Armored Guardian</p>
            </div>
            <!-- Character 2 -->
            <div class="character-card">
                <img src="the master.png" alt="The Fallen Master">
                <h3>The Master</h3>
                <p>The Spirit of Wisdom</p>
            </div>
            <!-- Character 3 -->
            <div class="character-card">
                <img src="the apprentice.png" alt="The Young Apprentice">
                <h3>The Apprentice</h3>
                <p>The Future of Honor</p>
            </div>
        </div>
    </div>

    <!-- FOOTER (Step 5 & Project Credits) -->
    <footer>
        <p>Atmospheric Soundtrack by [Your Audio Model Name]</p>
        <div class="process-tags">
            <span class="process-tag">LLM Storytelling</span>
            <span class="process-tag">Image Gen</span>
            <span class="process-tag">TTS Narration</span>
            <span class="process-tag">Audio Gen</span>
        </div>
        <p style="margin-top: 20px;">&copy; 2024 AI Storytelling Project Showcase</p>
    </footer>

        <script src="scripts/petals.js" defer></script>
        <script>
            (function () {
                const ambient = document.getElementById('ambient-audio');
                const toast = document.getElementById('audio-toast');
                const btn = document.getElementById('enable-audio-btn');
                const dismiss = document.getElementById('dismiss-audio-toast');
                if (!ambient) return;

                // Start muted programmatically so autoplay may start where allowed,
                // but show the toast so users can explicitly enable sound.
                try {
                    ambient.muted = true;
                    const p = ambient.play();
                    if (p && typeof p.catch === 'function') p.catch(() => {});
                } catch (e) { /* ignore */ }

                function hideToast() {
                    if (!toast) return;
                    toast.classList.add('hidden');
                    setTimeout(() => { if (toast) toast.style.display = 'none'; }, 220);
                }

                let activated = false;
                function activateAudio() {
                    if (activated) return;
                    activated = true;
                    window.removeEventListener('pointerdown', activateAudio);
                    window.removeEventListener('keydown', activateAudio);
                    try {
                        ambient.muted = false;
                        const playPromise = ambient.play();
                        if (playPromise && typeof playPromise.catch === 'function') {
                            playPromise.catch(() => {
                                ambient.muted = true;
                                ambient.play().then(() => { ambient.muted = false; }).catch(() => {});
                            });
                        }
                    } catch (e) {
                        ambient.muted = false;
                    }
                    hideToast();
                }

                window.addEventListener('pointerdown', activateAudio, { once: true });
                window.addEventListener('keydown', activateAudio, { once: true });

                if (btn) btn.addEventListener('click', function (e) { e.preventDefault(); activateAudio(); });
                if (dismiss) dismiss.addEventListener('click', function (e) { e.preventDefault(); hideToast(); });

                // show the toast so users notice the UI affordance
                if (toast) toast.style.display = 'flex';
            })();
        </script>
</body>
</html>